# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å –ª–∏—Å—Ç–æ–º "–¢—Ä–µ–Ω–¥—ã"

**–í–µ—Ç–∫–∞**: `feature/export-statistics-with-trends`
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-11-19

## –¶–µ–ª—å –∑–∞–¥–∞—á–∏

–î–æ–±–∞–≤–∏—Ç—å –≤—Ç–æ—Ä–æ–π –ª–∏—Å—Ç "–¢—Ä–µ–Ω–¥—ã" –≤ Excel —ç–∫—Å–ø–æ—Ä—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (results.html) —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è–º –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º.

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—á—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

1. **UI –∫–Ω–æ–ø–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞** (results.html:305, 687)
   - –î–≤–µ –∫–Ω–æ–ø–∫–∏: –≤ –ø–∞–Ω–µ–ª–∏ –¥–µ–π—Å—Ç–≤–∏–π –∏ –ø–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞
   - –í—ã–∑—ã–≤–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏—é `exportToExcel()`

2. **JavaScript —Ñ—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞** (results.html:1103-1153)
   - –§–æ—Ä–º–∏—Ä—É–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ `/statistics/export/excel`
   - –ü–µ—Ä–µ–¥–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
     - `templateId`, `clientId`
     - `exportSessionIds[]` (–º–∞—Å—Å–∏–≤ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π)
     - `warningPercentage`, `criticalPercentage` (–ø–æ—Ä–æ–≥–∏)
     - `filterField`, `filterValue` (–∞–∫—Ç–∏–≤–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä)

3. **Backend endpoint** (ExportStatisticsController.java:468-510)
   - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
   - –í—ã–∑—ã–≤–∞–µ—Ç `statisticsService.calculateComparison()` —Å —Ñ–∏–ª—å—Ç—Ä–æ–º
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç Excel —á–µ—Ä–µ–∑ `StatisticsExcelExportService`
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∞–π–ª –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

4. **–û—Å–Ω–æ–≤–Ω–æ–π –ª–∏—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** (StatisticsExcelExportService.java:35-72)
   - –¢–∞–±–ª–∏—Ü–∞ —Å –≥—Ä—É–ø–ø–∞–º–∏, –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
   - –¶–≤–µ—Ç–æ–≤–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π (–∑–µ–ª–µ–Ω—ã–π=—Ä–æ—Å—Ç, –∫—Ä–∞—Å–Ω—ã–π=–ø–∞–¥–µ–Ω–∏–µ)
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, % –∏–∑–º–µ–Ω–µ–Ω–∏—è, % –æ—Ç –æ–±—â–µ–≥–æ (–ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–µ)
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ `filterField` –∏ `filterValue`

5. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–µ–Ω–¥–æ–≤ –≤ UI** (results.html:1289-1290)
   - –ì—Ä–∞—Ñ–∏–∫–∏ —Ç—Ä–µ–Ω–¥–æ–≤ —É–∂–µ —É—á–∏—Ç—ã–≤–∞—é—Ç –∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã `activeFilterField` –∏ `activeFilterValue` –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ API
   - Backend –º–µ—Ç–æ–¥ `HistoricalStatisticsService.getHistoryForMetricAllGroups()` –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã (—Å—Ç—Ä–æ–∫–∏ 115-136)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–æ–≤–æ–º—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É

### –õ–∏—Å—Ç "–¢—Ä–µ–Ω–¥—ã" –≤ Excel

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**:
```
–ì—Ä—É–ø–ø–∞         | –ú–µ—Ç—Ä–∏–∫–∞              | –û–ø–µ—Ä–∞—Ü–∏—è #1    | –û–ø–µ—Ä–∞—Ü–∏—è #2    | –û–ø–µ—Ä–∞—Ü–∏—è #3    | ...
---------------|----------------------|----------------|----------------|----------------|----
–û–ë–©–ï–ï          | COMPETITOR_PRICE     | ‚Üë (+5.2%)     | ‚Üì (-2.1%)     | = (0%)        | ...
–û–ë–©–ï–ï          | DATE_MODIFICATIONS   | ‚Üë (+3.5%)     | = (0%)        | ‚Üë (+1.2%)     | ...
–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ê    | COMPETITOR_PRICE     | ‚Üì (-4.0%)     | ‚Üë (+2.5%)     | = (0%)        | ...
–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ê    | DATE_MODIFICATIONS   | ‚Üë (+1.5%)     | ‚Üë (+0.8%)     | ‚Üì (-1.0%)     | ...
...
```

**–°–∏–º–≤–æ–ª—ã –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**:
- ‚Üë (UP) - —Ä–æ—Å—Ç: –∑–µ–ª–µ–Ω—ã–π —Ñ–æ–Ω, –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç
- ‚Üì (DOWN) - –ø–∞–¥–µ–Ω–∏–µ: –∫—Ä–∞—Å–Ω—ã–π/–æ—Ä–∞–Ω–∂–µ–≤—ã–π —Ñ–æ–Ω, –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç
- = (STABLE) - –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: —Å–µ—Ä—ã–π —Ñ–æ–Ω, –æ–±—ã—á–Ω—ã–π —à—Ä–∏—Ñ—Ç
- –ü—Ä–æ—Ü–µ–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è: –≤ —Å–∫–æ–±–∫–∞—Ö –ø–æ—Å–ª–µ —Å–∏–º–≤–æ–ª–∞

**–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**:
- –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `StatisticsComparisonDto`
- –ü–æ–ª—è: `MetricValue.changeType`, `MetricValue.changePercentage`
- –î–∞–Ω–Ω—ã–µ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç—Ä–µ–Ω–¥–µ –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è**:
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ—Ç –∂–µ —Ñ–∏–ª—å—Ç—Ä, —á—Ç–æ –∏ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
- –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω `filterField` –∏ `filterValue` ‚Üí –ª–∏—Å—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ `ExportStatisticsService.calculateComparison()`
- –ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### –ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã

#### 1. StatisticsExcelExportService.java

**–§–∞–π–ª**: `src/main/java/com/java/service/statistics/StatisticsExcelExportService.java`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:

##### 1.1. –ú–µ—Ç–æ–¥ `generateExcel()` (—Å—Ç—Ä–æ–∫–∏ 35-72)

**–ë—ã–ª–æ**:
```java
public Path generateExcel(List<StatisticsComparisonDto> comparison, String clientName) {
    // ... —Å–æ–∑–¥–∞–Ω–∏–µ Workbook
    Sheet sheet = workbook.createSheet("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞");
    writeStatisticsSheet(sheet, comparison);
    // ... —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
}
```

**–°—Ç–∞–Ω–µ—Ç**:
```java
public Path generateExcel(List<StatisticsComparisonDto> comparison, String clientName) {
    // ... —Å–æ–∑–¥–∞–Ω–∏–µ Workbook

    // –õ–∏—Å—Ç 1: –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    Sheet statisticsSheet = workbook.createSheet("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞");
    writeStatisticsSheet(statisticsSheet, comparison);

    // –õ–∏—Å—Ç 2: –¢—Ä–µ–Ω–¥—ã
    Sheet trendsSheet = workbook.createSheet("–¢—Ä–µ–Ω–¥—ã");
    writeTrendsSheet(trendsSheet, comparison);

    // ... —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
}
```

##### 1.2. –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `writeTrendsSheet()`

```java
/**
 * –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –ª–∏—Å—Ç "–¢—Ä–µ–Ω–¥—ã" —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –º–µ—Ç—Ä–∏–∫
 *
 * @param sheet    –ª–∏—Å—Ç Excel –¥–ª—è –∑–∞–ø–∏—Å–∏
 * @param comparison –¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
 */
private void writeTrendsSheet(Sheet sheet, List<StatisticsComparisonDto> comparison) {
    int rowIndex = 0;

    // 1. –ó–ê–ì–û–õ–û–í–ö–ò
    // –°—Ç—Ä–æ–∫–∞ 1: –ì—Ä—É–ø–ø–∞ | –ú–µ—Ç—Ä–∏–∫–∞ | –û–ø–µ—Ä–∞—Ü–∏—è #1 | –û–ø–µ—Ä–∞—Ü–∏—è #2 | ...
    Row headerRow1 = sheet.createRow(rowIndex++);

    // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
    createCell(headerRow1, 0, "–ì—Ä—É–ø–ø–∞", styles.headerStyle);
    createCell(headerRow1, 1, "–ú–µ—Ç—Ä–∏–∫–∞", styles.headerStyle);

    // –ö–æ–ª–æ–Ω–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
    List<OperationStatistics> operations = comparison.get(0).getOperations();
    for (int i = 0; i < operations.size(); i++) {
        String operationLabel = "–û–ø–µ—Ä–∞—Ü–∏—è " + (i + 1);
        createCell(headerRow1, 2 + i, operationLabel, styles.headerStyle);
    }

    // –°—Ç—Ä–æ–∫–∞ 2: (–ø—É—Å—Ç–æ) | (–ø—É—Å—Ç–æ) | –ò–º—è –æ–ø–µ—Ä–∞—Ü–∏–∏ | –ò–º—è –æ–ø–µ—Ä–∞—Ü–∏–∏ | ...
    Row headerRow2 = sheet.createRow(rowIndex++);
    createCell(headerRow2, 0, "", styles.headerStyle);
    createCell(headerRow2, 1, "", styles.headerStyle);

    for (int i = 0; i < operations.size(); i++) {
        String operationName = operations.get(i).getOperationName();
        createCell(headerRow2, 2 + i, operationName, styles.headerStyle);
    }

    // 2. –î–ê–ù–ù–´–ï –¢–†–ï–ù–î–û–í
    for (StatisticsComparisonDto group : comparison) {
        String groupValue = group.getGroupFieldValue();

        // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã
        Map<String, List<MetricValue>> metricsByName = extractMetricsByName(group);

        for (Map.Entry<String, List<MetricValue>> entry : metricsByName.entrySet()) {
            String metricName = entry.getKey();
            List<MetricValue> metricValues = entry.getValue();

            Row dataRow = sheet.createRow(rowIndex++);

            // –ö–æ–ª–æ–Ω–∫–∞ "–ì—Ä—É–ø–ø–∞"
            createCell(dataRow, 0, groupValue,
                      groupValue.equals("–û–ë–©–ï–ï –ö–û–õ–ò–ß–ï–°–¢–í–û") ? styles.totalGroupStyle : styles.groupStyle);

            // –ö–æ–ª–æ–Ω–∫–∞ "–ú–µ—Ç—Ä–∏–∫–∞"
            createCell(dataRow, 1, metricName, styles.metricStyle);

            // –ö–æ–ª–æ–Ω–∫–∏ —Å —Ç—Ä–µ–Ω–¥–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
            for (int i = 0; i < metricValues.size(); i++) {
                MetricValue metricValue = metricValues.get(i);
                String trendText = formatTrendCell(metricValue);
                CellStyle trendStyle = determineTrendStyle(metricValue);

                createCell(dataRow, 2 + i, trendText, trendStyle);
            }
        }
    }

    // 3. –ù–ê–°–¢–†–û–ô–ö–ò –õ–ò–°–¢–ê
    // –ó–∞–∫—Ä–µ–ø–∏—Ç—å –ø–µ—Ä–≤—ã–µ 2 —Å—Ç—Ä–æ–∫–∏ (–∑–∞–≥–æ–ª–æ–≤–∫–∏)
    sheet.createFreezePane(0, 2);

    // –ó–∞–∫—Ä–µ–ø–∏—Ç—å –ø–µ—Ä–≤—ã–µ 2 –∫–æ–ª–æ–Ω–∫–∏ (–ì—Ä—É–ø–ø–∞ + –ú–µ—Ç—Ä–∏–∫–∞)
    sheet.createFreezePane(2, 0);

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
    for (int i = 0; i < 2 + operations.size(); i++) {
        sheet.autoSizeColumn(i);
    }
}

/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —è—á–µ–π–∫—É —Ç—Ä–µ–Ω–¥–∞: —Å–∏–º–≤–æ–ª + –ø—Ä–æ—Ü–µ–Ω—Ç
 *
 * –ü—Ä–∏–º–µ—Ä—ã:
 * - "‚Üë (+5.2%)"  –¥–ª—è —Ä–æ—Å—Ç–∞ –Ω–∞ 5.2%
 * - "‚Üì (-2.1%)"  –¥–ª—è –ø–∞–¥–µ–Ω–∏—è –Ω–∞ 2.1%
 * - "= (0%)"     –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
 * - "-"          –¥–ª—è –ø–µ—Ä–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ (–Ω–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è)
 */
private String formatTrendCell(MetricValue metricValue) {
    if (metricValue.getPreviousValue() == null) {
        return "-"; // –ù–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    }

    ChangeType changeType = metricValue.getChangeType();
    Double changePercentage = metricValue.getChangePercentage();

    if (changePercentage == null) {
        return "= (0%)";
    }

    String symbol;
    String sign;

    switch (changeType) {
        case UP:
            symbol = "‚Üë";
            sign = "+";
            break;
        case DOWN:
            symbol = "‚Üì";
            sign = "";  // –ú–∏–Ω—É—Å —É–∂–µ –≤ —á–∏—Å–ª–µ
            break;
        case STABLE:
        default:
            symbol = "=";
            return symbol + " (0%)";
    }

    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç —Å 1 –∑–Ω–∞–∫–æ–º –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
    String formattedPercentage = String.format("%.1f", Math.abs(changePercentage));

    return String.format("%s (%s%s%%)", symbol, sign, formattedPercentage);
}

/**
 * –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–∏–ª—å —è—á–µ–π–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —É—Ä–æ–≤–Ω—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
 *
 * @param metricValue –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ç—Ä–µ–Ω–¥–µ
 * @return —Å—Ç–∏–ª—å —è—á–µ–π–∫–∏
 */
private CellStyle determineTrendStyle(MetricValue metricValue) {
    if (metricValue.getPreviousValue() == null) {
        return styles.normalStyle; // –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    }

    ChangeType changeType = metricValue.getChangeType();
    AlertLevel alertLevel = metricValue.getAlertLevel();

    if (changeType == ChangeType.STABLE) {
        return styles.normalStyle; // –°–µ—Ä—ã–π —Ñ–æ–Ω –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö
    }

    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∏–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —É—Ä–æ–≤–Ω—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
    if (changeType == ChangeType.UP) {
        return (alertLevel == AlertLevel.CRITICAL)
            ? styles.increaseCriticalStyle   // –Ø—Ä–∫–∏–π –∑–µ–ª–µ–Ω—ã–π (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–æ—Å—Ç)
            : styles.increaseWarningStyle;    // –°–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ —Ä–æ—Å—Ç–µ)
    } else { // DOWN
        return (alertLevel == AlertLevel.CRITICAL)
            ? styles.decreaseCriticalStyle    // –Ø—Ä–∫–∏–π –∫—Ä–∞—Å–Ω—ã–π (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –ø–∞–¥–µ–Ω–∏–µ)
            : styles.decreaseWarningStyle;     // –°–≤–µ—Ç–ª–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –ø–∞–¥–µ–Ω–∏–∏)
    }
}

/**
 * –ò–∑–≤–ª–µ–∫–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∏–∑ –≥—Ä—É–ø–ø—ã, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –º–µ—Ç—Ä–∏–∫–∏
 *
 * @param group –≥—Ä—É–ø–ø–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
 * @return Map: –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ -> —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ –æ–ø–µ—Ä–∞—Ü–∏—è–º
 */
private Map<String, List<MetricValue>> extractMetricsByName(StatisticsComparisonDto group) {
    Map<String, List<MetricValue>> result = new LinkedHashMap<>();

    List<OperationStatistics> operations = group.getOperations();

    // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –º–µ—Ç—Ä–∏–∫
    Set<String> allMetricNames = new LinkedHashSet<>();
    for (OperationStatistics operation : operations) {
        allMetricNames.addAll(operation.getMetrics().keySet());
    }

    // –î–ª—è –∫–∞–∂–¥–æ–π –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –≤—Å–µ–º –æ–ø–µ—Ä–∞—Ü–∏—è–º
    for (String metricName : allMetricNames) {
        List<MetricValue> metricValues = new ArrayList<>();

        for (OperationStatistics operation : operations) {
            MetricValue metricValue = operation.getMetrics().get(metricName);
            metricValues.add(metricValue != null ? metricValue : createEmptyMetricValue());
        }

        result.put(metricName, metricValues);
    }

    return result;
}

/**
 * –°–æ–∑–¥–∞–µ—Ç –ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (–¥–ª—è —Å–ª—É—á–∞–µ–≤ –∫–æ–≥–¥–∞ –º–µ—Ç—Ä–∏–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
 */
private MetricValue createEmptyMetricValue() {
    MetricValue empty = new MetricValue();
    empty.setCurrentValue(0L);
    empty.setPreviousValue(null);
    empty.setChangePercentage(0.0);
    empty.setChangeType(ChangeType.STABLE);
    empty.setAlertLevel(AlertLevel.NORMAL);
    return empty;
}

/**
 * –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —è—á–µ–π–∫–∏ —Å —Ç–µ–∫—Å—Ç–æ–º –∏ —Å—Ç–∏–ª–µ–º
 */
private void createCell(Row row, int columnIndex, String value, CellStyle style) {
    Cell cell = row.createCell(columnIndex);
    cell.setCellValue(value);
    cell.setCellStyle(style);
}
```

##### 1.3. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å—Ç–∏–ª–µ–π

–°—Ç–∏–ª–∏ —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –∫–ª–∞—Å—Å–µ `ExcelStyles` (—Å—Ç—Ä–æ–∫–∏ 313-427):
- `headerStyle` - –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–ª–æ–Ω–æ–∫
- `groupStyle` - –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã
- `totalGroupStyle` - —Å—Ç—Ä–æ–∫–∞ "–û–ë–©–ï–ï –ö–û–õ–ò–ß–ï–°–¢–í–û"
- `metricStyle` - –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏
- `normalStyle` - –æ–±—ã—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- `increaseWarningStyle` - —Ä–æ—Å—Ç (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ) - —Å–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π
- `increaseCriticalStyle` - —Ä–æ—Å—Ç (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ) - —è—Ä–∫–æ-–∑–µ–ª–µ–Ω—ã–π
- `decreaseWarningStyle` - –ø–∞–¥–µ–Ω–∏–µ (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ) - —Å–≤–µ—Ç–ª–æ-–æ—Ä–∞–Ω–∂–µ–≤—ã–π
- `decreaseCriticalStyle` - –ø–∞–¥–µ–Ω–∏–µ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ) - —è—Ä–∫–æ-–∫—Ä–∞—Å–Ω—ã–π

**–ù–∏–∫–∞–∫–∏—Ö –Ω–æ–≤—ã—Ö —Å—Ç–∏–ª–µ–π —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!**

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ—à–µ–Ω–∏—è

### 1. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (`StatisticsExcelExportService.java`)
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ UI, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ, JavaScript
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ª–æ–≥–∏–∫–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### 2. –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ `StatisticsComparisonDto`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ –∂–µ —Å—Ç–∏–ª–∏ `ExcelStyles`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ –ø—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–∞

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ `ExportStatisticsService.calculateComparison()`
- ‚úÖ –û–±–∞ –ª–∏—Å—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

### 4. –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å UI
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–µ–Ω–¥–æ–≤ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ UI
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç–æ–º—É, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ

## –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (5 –º–∏–Ω)
1. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤–µ—Ç–∫–∞ `feature/export-statistics-with-trends` –∞–∫—Ç–∏–≤–Ω–∞
2. –û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª `StatisticsExcelExportService.java`
3. –ò–∑—É—á–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª–∞—Å—Å–∞ `StatisticsComparisonDto` –∏ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤

### –≠—Ç–∞–ø 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–∞ `writeTrendsSheet()` (30 –º–∏–Ω)
1. –°–æ–∑–¥–∞—Ç—å –º–µ—Ç–æ–¥ —Å —Å–∏–≥–Ω–∞—Ç—É—Ä–æ–π `private void writeTrendsSheet(Sheet sheet, List<StatisticsComparisonDto> comparison)`
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (2 —Å—Ç—Ä–æ–∫–∏)
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –∏ –º–µ—Ç—Ä–∏–∫–∏
4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–∏–ª–∏

### –≠—Ç–∞–ø 3: –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã (20 –º–∏–Ω)
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `formatTrendCell()` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–∞ + –ø—Ä–æ—Ü–µ–Ω—Ç
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `determineTrendStyle()` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∏–ª—è —è—á–µ–π–∫–∏
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `extractMetricsByName()` - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∏–∑ –≥—Ä—É–ø–ø—ã
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `createEmptyMetricValue()` - –ø—É—Å—Ç–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `createCell()` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —è—á–µ–π–∫–∏

### –≠—Ç–∞–ø 4: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `generateExcel()` (5 –º–∏–Ω)
1. –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `generateExcel()`
2. –ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è –ø–µ—Ä–≤–æ–≥–æ –ª–∏—Å—Ç–∞ –Ω–∞ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"
3. –î–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –ª–∏—Å—Ç–∞ "–¢—Ä–µ–Ω–¥—ã"
4. –í—ã–∑–≤–∞—Ç—å `writeTrendsSheet()` –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –ª–∏—Å—Ç–∞

### –≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (30 –º–∏–Ω)
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `mvn spring-boot:run -Dspring-boot.run.profiles=silent`
2. –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: http://localhost:8081/statistics/setup
3. –í—ã–±—Ä–∞—Ç—å —à–∞–±–ª–æ–Ω –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π
4. –ù–∞–∂–∞—Ç—å "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å"
5. –ù–∞–∂–∞—Ç—å "–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel"
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –¥–≤—É—Ö –ª–∏—Å—Ç–æ–≤: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" –∏ "–¢—Ä–µ–Ω–¥—ã"
7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ª–∏—Å—Ç–µ "–¢—Ä–µ–Ω–¥—ã"
8. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–≤–µ—Ç–æ–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∑–µ–ª–µ–Ω—ã–π/–∫—Ä–∞—Å–Ω—ã–π/—Å–µ—Ä—ã–π)
9. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ results.html
10. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
11. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –æ–±–∞ –ª–∏—Å—Ç–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### –≠—Ç–∞–ø 6: –ö–æ–º–º–∏—Ç –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è (10 –º–∏–Ω)
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∏–ª—é –ø—Ä–æ–µ–∫—Ç–∞
2. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–µ —Å–ª–æ–º–∞–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
3. –°–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
4. –û–±–Ω–æ–≤–∏—Ç—å CLAUDE.md (–¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª–∏—Å—Ç–µ "–¢—Ä–µ–Ω–¥—ã")

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–∑–æ–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞
**–®–∞–≥–∏**:
1. –í—ã–±—Ä–∞—Ç—å —à–∞–±–ª–æ–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
2. –í—ã–±—Ä–∞—Ç—å 3-4 –æ–ø–µ—Ä–∞—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
3. –ù–∞–∂–∞—Ç—å "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å"
4. –ù–∞–∂–∞—Ç—å "–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç 2 –ª–∏—Å—Ç–∞: "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" –∏ "–¢—Ä–µ–Ω–¥—ã"
- ‚úÖ –õ–∏—Å—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–±–ª–∏—Ü—É —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º
- ‚úÖ –õ–∏—Å—Ç "–¢—Ä–µ–Ω–¥—ã" —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∏–º–≤–æ–ª—ã ‚Üë/‚Üì/= —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏
- ‚úÖ –¶–≤–µ—Ç–æ–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ó–∞–∫—Ä–µ–ø–ª–µ–Ω—ã –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –ø–µ—Ä–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –≠–∫—Å–ø–æ—Ä—Ç —Å —Ñ–∏–ª—å—Ç—Ä–æ–º
**–®–∞–≥–∏**:
1. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ results.html –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, competitorStockStatus = "–í –Ω–∞–ª–∏—á–∏–∏")
2. –ù–∞–∂–∞—Ç—å "–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –û–±–∞ –ª–∏—Å—Ç–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ –ø–æ —Ñ–∏–ª—å—Ç—Ä—É
- ‚úÖ –ì—Ä—É–ø–ø—ã, –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—É, –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã —Å —É—á–µ—Ç–æ–º —Ñ–∏–ª—å—Ç—Ä–∞
- ‚úÖ –¢—Ä–µ–Ω–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –≠–∫—Å–ø–æ—Ä—Ç —Å –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π
**–®–∞–≥–∏**:
1. –í—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –õ–∏—Å—Ç "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–¥–Ω—É –∫–æ–ª–æ–Ω–∫—É –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –õ–∏—Å—Ç "–¢—Ä–µ–Ω–¥—ã" —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª "-" (–Ω–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –æ—à–∏–±–æ–∫ –∏–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –≠–∫—Å–ø–æ—Ä—Ç —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è–º–∏
**–®–∞–≥–∏**:
1. –í—ã–±—Ä–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–æ–ª—å—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –º–µ—Ç—Ä–∏–∫
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∏–∑–∫–∏–µ –ø–æ—Ä–æ–≥–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, warning=5%, critical=10%)
3. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –Ø—á–µ–π–∫–∏ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ >10% –∏–º–µ—é—Ç —è—Ä–∫–∏–π —Ü–≤–µ—Ç (–∑–µ–ª–µ–Ω—ã–π –∏–ª–∏ –∫—Ä–∞—Å–Ω—ã–π)
- ‚úÖ –Ø—á–µ–π–∫–∏ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ 5-10% –∏–º–µ—é—Ç —Å–≤–µ—Ç–ª—ã–π —Ü–≤–µ—Ç
- ‚úÖ –Ø—á–µ–π–∫–∏ —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ <5% –∏–º–µ—é—Ç –æ–±—ã—á–Ω—ã–π —Å—Ç–∏–ª—å

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö `StatisticsComparisonDto`

```java
public class StatisticsComparisonDto {
    private String groupFieldValue;              // "–û–ë–©–ï–ï –ö–û–õ–ò–ß–ï–°–¢–í–û" –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã
    private List<OperationStatistics> operations; // –°–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π

    public static class OperationStatistics {
        private Long exportSessionId;
        private Long operationId;
        private String operationName;            // –ò–º—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
        private ZonedDateTime exportDate;
        private Map<String, MetricValue> metrics; // Map: –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ -> –∑–Ω–∞—á–µ–Ω–∏–µ
        private DateModificationStats dateModificationStats;
    }

    public static class MetricValue {
        private Long currentValue;               // –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
        private Long previousValue;              // –ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å null –¥–ª—è –ø–µ—Ä–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏)
        private Double changePercentage;         // –ü—Ä–æ—Ü–µ–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è
        private ChangeType changeType;           // UP, DOWN, STABLE
        private AlertLevel alertLevel;           // NORMAL, WARNING, CRITICAL
        private Double percentageOfTotal;        // % –æ—Ç –æ–±—â–µ–≥–æ (–ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–µ)
        private Long totalValue;                 // –û–±—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞
    }

    public enum ChangeType { UP, DOWN, STABLE }
    public enum AlertLevel { NORMAL, WARNING, CRITICAL }
}
```

### –°–∏–º–≤–æ–ª—ã Unicode –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤

- `‚Üë` - U+2191 - UPWARDS ARROW (—Ä–æ—Å—Ç)
- `‚Üì` - U+2193 - DOWNWARDS ARROW (–ø–∞–¥–µ–Ω–∏–µ)
- `=` - U+003D - EQUALS SIGN (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

### –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞ (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏)

| –°—Ç–∏–ª—å | –¢–∏–ø –∏–∑–º–µ–Ω–µ–Ω–∏—è | –£—Ä–æ–≤–µ–Ω—å | –¶–≤–µ—Ç —Ñ–æ–Ω–∞ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|-------|---------------|---------|-----------|------------|
| `increaseWarningStyle` | UP | WARNING | Light Green (#d1e7dd) | –†–æ—Å—Ç 5-10% |
| `increaseCriticalStyle` | UP | CRITICAL | Lime (#badbcc) | –†–æ—Å—Ç >10% |
| `decreaseWarningStyle` | DOWN | WARNING | Light Orange (#fff3cd) | –ü–∞–¥–µ–Ω–∏–µ 5-10% |
| `decreaseCriticalStyle` | DOWN | CRITICAL | Coral (#f8d7da) | –ü–∞–¥–µ–Ω–∏–µ >10% |
| `normalStyle` | STABLE | NORMAL | White | –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π |

## –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –†–∞–∑–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ç—Ä–∏–∫ –≤ —Ä–∞–∑–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `extractMetricsByName()` –¥–ª—è —Å–±–æ—Ä–∞ –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫, —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ç—Ä–∏–∫.

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ü–µ—Ä–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—è—Ç—å `previousValue == null`, –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–∏–º–≤–æ–ª "-" –≤–º–µ—Å—Ç–æ —Ç—Ä–µ–Ω–¥–∞.

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –°–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–ø–µ—Ä–∞—Ü–∏–π
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `autoSizeColumn()` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —à–∏—Ä–∏–Ω—ã, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç —à–∏—Ä–∏–Ω—ã.

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—É—Å—Ç—ã–º –≥—Ä—É–ø–ø–∞–º
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é —Å—Ç—Ä–æ–∫–∏, –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –ø—É—Å—Ç—ã–µ –≥—Ä—É–ø–ø—ã.

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ (Checklist)

### –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [x] –°–æ–∑–¥–∞–Ω–∞ –≤–µ—Ç–∫–∞ `feature/export-statistics-with-trends`
- [x] –ò–∑—É—á–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `StatisticsComparisonDto`
- [x] –ò–∑—É—á–µ–Ω –∫–ª–∞—Å—Å `StatisticsExcelExportService`
- [x] –ü–æ–Ω—è—Ç–µ–Ω –º–µ—Ö–∞–Ω–∏–∑–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- [ ] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç—Ä–µ–Ω–¥–∞–º–∏)

### –í–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `writeTrendsSheet()`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `formatTrendCell()`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `determineTrendStyle()` (renamed to `determineTrendCellStyle()`)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `extractMetricsByName()`
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤—ã–∑–æ–≤ –≤ `generateExcel()`
- [x] –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–µ–Ω –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∏–ª—é –ø—Ä–æ–µ–∫—Ç–∞
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã JavaDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ (mvn clean compile)
- [x] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [x] –ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ http://localhost:8081
- [ ] –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –ë–∞–∑–æ–≤—ã–π —ç–∫—Å–ø–æ—Ä—Ç –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞ (—Ç—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- [ ] –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: –≠–∫—Å–ø–æ—Ä—Ç —Å —Ñ–∏–ª—å—Ç—Ä–æ–º (—Ç—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–≤—É—Ö –ª–∏—Å—Ç–æ–≤ –≤ Excel —Ñ–∞–π–ª–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–≤–µ—Ç–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–º–≤–æ–ª–æ–≤ Unicode (‚Üë‚Üì=)

### –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
- [ ] –°–æ–∑–¥–∞–Ω –∫–æ–º–º–∏—Ç —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω CLAUDE.md
- [ ] –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω
- [ ] –í–µ—Ç–∫–∞ –≥–æ—Ç–æ–≤–∞ –∫ merge –≤ main

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£–ª—É—á—à–µ–Ω–∏–µ 1: –£—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Excel
–î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Ç–∏–≤–Ω–æ–µ —É—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Excel –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∏–ª–µ–π. –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑–º–µ–Ω—è—Ç—å –ø–æ—Ä–æ–≥–∏ –≤ Excel.

### –£–ª—É—á—à–µ–Ω–∏–µ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä—è–¥–∫–∞ –º–µ—Ç—Ä–∏–∫
–î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—è–¥–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ (—Å–µ–π—á–∞—Å –ø–æ—Ä—è–¥–æ–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ—Ä—è–¥–∫–æ–º –≤ Map).

### –£–ª—É—á—à–µ–Ω–∏–µ 3: –õ–∏—Å—Ç "–°–≤–æ–¥–∫–∞"
–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ—Ç–∏–π –ª–∏—Å—Ç "–°–≤–æ–¥–∫–∞" —Å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π
- –¢–æ–ø-5 –≥—Ä—É–ø–ø —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏

### –£–ª—É—á—à–µ–Ω–∏–µ 4: –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
–î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ –ª–∏—Å—Ç–∞ "–¢—Ä–µ–Ω–¥—ã" –≤ CSV —Ñ–æ—Ä–º–∞—Ç (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ª–∏—Å—Ç—É).

## –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

- [Apache POI Documentation](https://poi.apache.org/components/spreadsheet/)
- [CLAUDE.md - Export Statistics Section](./CLAUDE.md#export-statistics-with-multi-dimensional-filtering)
- [StatisticsComparisonDto Source](./src/main/java/com/java/dto/StatisticsComparisonDto.java)
- [StatisticsExcelExportService Source](./src/main/java/com/java/service/statistics/StatisticsExcelExportService.java)

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

| –î–∞—Ç–∞ | –ê–≤—Ç–æ—Ä | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-------|-----------|
| 2025-11-19 | Claude Code | –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ |

---

**–°—Ç–∞—Ç—É—Å**: ‚è≥ –í –æ–∂–∏–¥–∞–Ω–∏–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî• –í—ã—Å–æ–∫–∏–π
**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: ‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è (1-2 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã)