# –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: –£–ª—É—á—à–µ–Ω–∏–µ RedirectCollectorService

### –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ

| –ò—Ç–µ—Ä–∞—Ü–∏—è | –°—Ç–∞—Ç—É—Å | –û–ø–∏—Å–∞–Ω–∏–µ                                                              |
|:--------:|:------:|-----------------------------------------------------------------------|
| **0**    |   ‚úîÔ∏è    | –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –æ—à–∏–±–∫–∏.    |
| **1**    |   ‚úîÔ∏è    | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤.                    |
| **2**    |   ‚ñ∂Ô∏è    | –ü–æ–≤—ã—à–µ–Ω–∏–µ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏: User-Agent, —Ç–∞–π–º–∞—É—Ç—ã –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫.        |
| **3**    |   üìã    | –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è "–º—è–≥–∫–∏—Ö" –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫. |
| **4**    |   üìã    | –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥: –∑–∞–º–µ–Ω–∞ —Å—Ç—Ä–æ–∫–æ–≤—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç –Ω–∞ `enum` –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤.         |
| **5**    |   üìã    | (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Spring `WebClient` –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã.   |

---

## –ü–ª–∞–Ω –∑–∞–¥–∞—á

### –ò—Ç–µ—Ä–∞—Ü–∏—è 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π –º–æ–¥—É–ª—å–Ω—ã–π —Ç–µ—Å—Ç (Unit Test) –¥–ª—è `RedirectCollectorService`, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç URL —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–∞—á–µ–π. –≠—Ç–æ –±—É–¥–µ—Ç –Ω–∞—à–µ–π —Ç–æ—á–∫–æ–π –æ—Ç—Å—á–µ—Ç–∞.

### –ò—Ç–µ—Ä–∞—Ü–∏—è 1: –ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–±–æ—Ä–∞ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤
- [x] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `RedirectCollectorService`, –≤–Ω–µ–¥—Ä–∏–≤ –ª–æ–≥–∏–∫—É –Ω–∞ `HttpURLConnection`.
- [x] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `setInstanceFollowRedirects(false)`, —á—Ç–æ–±—ã –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞–º.
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ü–∏–∫–ª, –∫–æ—Ç–æ—Ä—ã–π –≤—Ä—É—á–Ω—É—é "–ø—Ä–æ—Ö–æ–¥–∏—Ç" –ø–æ —Ü–µ–ø–æ—á–∫–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–≤ –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ (–Ω–µ 3xx).
- [x] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ç–µ—Å—Ç –∏–∑ –ò—Ç–µ—Ä–∞—Ü–∏–∏ 0 —Ç–µ–ø–µ—Ä—å –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ.

### –ò—Ç–µ—Ä–∞—Ü–∏—è 2: –ü–æ–≤—ã—à–µ–Ω–∏–µ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `User-Agent`, —á—Ç–æ–±—ã –º–∏–º–∏–∫—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –±—Ä–∞—É–∑–µ—Ä.
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã –Ω–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ —á—Ç–µ–Ω–∏–µ (`setConnectTimeout`, `setReadTimeout`).
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É `SocketTimeoutException` –∏ –¥—Ä—É–≥–∏—Ö `IOException`, –ø—Ä–∏—Å–≤–∞–∏–≤–∞—è –∏–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∞—Ç—É—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `BLOCKED` –∏–ª–∏ `ERROR`).

### –ò—Ç–µ—Ä–∞—Ü–∏—è 3: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ "–º—è–≥–∫–∏—Ö" –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- [ ] –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ `200 OK`, –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —á—Ç–µ–Ω–∏—è –ø–µ—Ä–≤—ã—Ö –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∏–ª–æ–±–∞–π—Ç HTML-—Ç–µ–ª–∞ –æ—Ç–≤–µ—Ç–∞.
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –Ω–∞ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (`captcha`, `access denied`, `–¥–æ—Å—Ç—É–ø –æ–≥—Ä–∞–Ω–∏—á–µ–Ω` –∏ —Ç.–¥.) –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–∫—Ä—ã—Ç—ã—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.

### –ò—Ç–µ—Ä–∞—Ü–∏—è 4: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∏ —É–ª—É—á—à–µ–Ω–∏–µ –∫–æ–¥–∞
- [ ] –°–æ–∑–¥–∞—Ç—å `enum PageStatus { OK, REDIRECT, BLOCKED, NOT_FOUND, ERROR }`.
- [ ] –ó–∞–º–µ–Ω–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ª–∏—Ç–µ—Ä–∞–ª—ã —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ –∫–æ–¥–µ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ `enum`.

### –ò—Ç–µ—Ä–∞—Ü–∏—è 5: –ú–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—è (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏–∫—É —Å `HttpURLConnection` –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π `WebClient` –∏–∑ Spring WebFlux.
- [ ] –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π.