# Task List: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ø–æ–ª—è–º

> **–ü—Ä–æ–µ–∫—Ç:** Zoomos v4
> **–§–∏—á–∞:** –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
> **–í–µ—Ç–∫–∞:** `feature/statistics-filter-fields`
> **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [idea_extend_statistics.md](idea_extend_statistics.md)

---

## üìä –ü—Ä–æ–≥—Ä–µ—Å—Å

| –ò—Ç–µ—Ä–∞—Ü–∏—è | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å | –î–∞—Ç–∞ | –í—Ä–µ–º—è |
|----------|--------|--------|------|-------|
| 1 | –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ë–î (–º–∏–≥—Ä–∞—Ü–∏—è + entity) | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 2025-10-04 | 1—á |
| 2 | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 2025-10-04 | 1—á |
| 3 | Repository –º–µ—Ç–æ–¥—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 2025-10-04 | 30–º–∏–Ω |
| 4 | –°–µ—Ä–≤–∏—Å: –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º | ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ | 2025-10-04 | 30–º–∏–Ω |
| 5 | API: —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏–π —Ñ–∏–ª—å—Ç—Ä–æ–≤ | ‚è≥ –û–∂–∏–¥–∞–µ—Ç | - | - |
| 6 | UI: –ø–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ + JavaScript | ‚è≥ –û–∂–∏–¥–∞–µ—Ç | - | - |
| 7 | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä + —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚è≥ –û–∂–∏–¥–∞–µ—Ç | - | - |

### –õ–µ–≥–µ–Ω–¥–∞ —Å—Ç–∞—Ç—É—Å–æ–≤
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç
- üîÑ –í —Ä–∞–±–æ—Ç–µ
- ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ
- ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã
- ‚ùå –û—Ç–º–µ–Ω–µ–Ω–æ

### –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å: 4/7 (57%)

---

## üéØ –ò—Ç–µ—Ä–∞—Ü–∏–∏

### –ò—Ç–µ—Ä–∞—Ü–∏—è 1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ë–î

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–ó–∞–¥–∞—á–∏:**
- [x] –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é `V15__add_filter_fields_to_export_statistics.sql`
  - –î–æ–±–∞–≤–∏—Ç—å `filter_field_name VARCHAR(255)`
  - –î–æ–±–∞–≤–∏—Ç—å `filter_field_value VARCHAR(255)`
  - –°–æ–∑–¥–∞—Ç—å –∏–Ω–¥–µ–∫—Å `idx_export_statistics_filter`
  - –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –ø–æ–ª—è–º
- [x] –û–±–Ω–æ–≤–∏—Ç—å `ExportStatistics.java`
  - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `filterFieldName`
  - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `filterFieldValue`
  - –î–æ–±–∞–≤–∏—Ç—å Lombok –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏

**–¢–µ—Å—Ç:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
mvn flyway:migrate

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã
psql -d zoomos_v4 -c "\d export_statistics"
```

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ü–æ–ª—è `filter_field_name` –∏ `filter_field_value` –¥–æ–±–∞–≤–ª–µ–Ω—ã
- ‚úÖ –ò–Ω–¥–µ–∫—Å —Å–æ–∑–¥–∞–Ω

---

### –ò—Ç–µ—Ä–∞—Ü–∏—è 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–¶–µ–ª—å:** –ü—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞

**–ó–∞–¥–∞—á–∏:**
- [x] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `ExportStatisticsWriterService.saveExportStatistics()`
  - –ü–æ–ª—É—á–∞—Ç—å `statisticsFilterFields` –∏–∑ —à–∞–±–ª–æ–Ω–∞
  - –°–æ—Ö—Ä–∞–Ω—è—Ç—å –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É (filter = NULL)
  - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:
    - –ü–æ–ª—É—á–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–µ
    - –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é
    - –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏
    - –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ñ–∏–ª—å—Ç—Ä–∞
- [x] –î–æ–±–∞–≤–∏—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
  - `getUniqueFilterValues()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
  - `filterDataByValue()` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –∑–Ω–∞—á–µ–Ω–∏—é
  - `calculateStatistics()` - –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–¢–µ—Å—Ç:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
mvn spring-boot:run -Dspring-boot.run.profiles=silent

# –í—ã–ø–æ–ª–Ω–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç —Å —à–∞–±–ª–æ–Ω–æ–º, –≥–¥–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã statisticsFilterFields
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –ë–î
psql -d zoomos_v4 -c "
SELECT group_field_value, count_field_name,
       filter_field_name, filter_field_value, count_value
FROM export_statistics
WHERE export_session_id = [ID_–ü–û–°–õ–ï–î–ù–ï–ô_–°–ï–°–°–ò–ò]
ORDER BY group_field_value, count_field_name, filter_field_value;
"
```

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ —Å `filter_field_name = NULL` (–æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- ‚úÖ –°–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–ø–∏—Å–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π = –≥—Ä—É–ø–ø—ã √ó –º–µ—Ç—Ä–∏–∫–∏ √ó (1 + –∫–æ–ª-–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π —Ñ–∏–ª—å—Ç—Ä–∞)
- ‚úÖ –°—É–º–º—ã –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

---

### –ò—Ç–µ—Ä–∞—Ü–∏—è 3: Repository –º–µ—Ç–æ–¥—ã

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º

**–ó–∞–¥–∞—á–∏:**
- [x] –†–∞—Å—à–∏—Ä–∏—Ç—å `ExportStatisticsRepository`
  - `findBySessionIdsWithoutFilter()` - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  - `findBySessionIdsAndFilter()` - –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  - `findDistinctFilterValues()` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
  - `findDistinctFilterFields()` - –≤—Å–µ –ø–æ–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

**–¢–µ—Å—Ç:**
```java
// –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π –º–µ—Ç–æ–¥ –∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ REST client
@Test
public void testRepositoryMethods() {
    // 1. –ü–æ–ª—É—á–∏—Ç—å –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    List<ExportStatistics> general = repository.findBySessionIdsWithoutFilter(List.of(sessionId));
    assertThat(general).isNotEmpty();
    assertThat(general.get(0).getFilterFieldName()).isNull();

    // 2. –ü–æ–ª—É—á–∏—Ç—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    List<ExportStatistics> filtered = repository.findBySessionIdsAndFilter(
        List.of(sessionId), "competitorStockStatus", "–í –Ω–∞–ª–∏—á–∏–∏"
    );
    assertThat(filtered).isNotEmpty();
    assertThat(filtered.get(0).getFilterFieldValue()).isEqualTo("–í –Ω–∞–ª–∏—á–∏–∏");

    // 3. –ü–æ–ª—É—á–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    List<String> values = repository.findDistinctFilterValues(
        List.of(sessionId), "competitorStockStatus"
    );
    assertThat(values).contains("–í –Ω–∞–ª–∏—á–∏–∏", "–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏");
}
```

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ—á–Ω–æ
- ‚úÖ –ù–µ—Ç N+1 Query –ø—Ä–æ–±–ª–µ–º

---

### –ò—Ç–µ—Ä–∞—Ü–∏—è 4: –°–µ—Ä–≤–∏—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–¶–µ–ª—å:** –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

**–ó–∞–¥–∞—á–∏:**
- [x] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å `ExportStatisticsService.calculateComparison()`
  - –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `filterFieldName`, `filterFieldValue`
  - –í—ã–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞–ª–∏—á–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
  - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å (–ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –º–µ—Ç–æ–¥–∞)

**–¢–µ—Å—Ç:**
```bash
# –ß–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ REST client
# 1. –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ë–ï–ó —Ñ–∏–ª—å—Ç—Ä–∞
GET /statistics/results?clientId=1&templateId=1&exportSessionIds=1,2&warningPercentage=10&criticalPercentage=20

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –ø–æ–∫–∞–∑–∞–Ω—ã –æ–±—â–∏–µ –∏—Ç–æ–≥–∏

# 2. –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –° —Ñ–∏–ª—å—Ç—Ä–æ–º
GET /statistics/results?...&filterField=competitorStockStatus&filterValue=–í%20–Ω–∞–ª–∏—á–∏–∏

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —Ü–∏—Ñ—Ä—ã –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –æ–±—â–∏—Ö, –ø–æ–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è "–í –Ω–∞–ª–∏—á–∏–∏"
```

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –ë–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- ‚úÖ –° —Ñ–∏–ª—å—Ç—Ä–æ–º –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–æ–≤

---

### –ò—Ç–µ—Ä–∞—Ü–∏—è 5: API —ç–Ω–¥–ø–æ–∏–Ω—Ç

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

**–ó–∞–¥–∞—á–∏:**
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤ `StatisticsController`:
  - –ú–µ—Ç–æ–¥ `getFilterValues()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Map<–ø–æ–ª–µ, List<–∑–Ω–∞—á–µ–Ω–∏—è>>
  - –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ `parseJsonStringList()`
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `showResults()`:
  - –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `filterField`, `filterValue`
  - –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Ö –≤ —Å–µ—Ä–≤–∏—Å

**–¢–µ—Å—Ç:**
```bash
# –¢–µ—Å—Ç API —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞
curl "http://localhost:8081/statistics/filter-values?templateId=1&sessionIds=1,2,3"

# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
{
  "competitorStockStatus": ["–í –Ω–∞–ª–∏—á–∏–∏", "–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏", "–ü–æ–¥ –∑–∞–∫–∞–∑"]
}
```

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:**
- ‚úÖ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–º –≤ –ë–î
- ‚úÖ –ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª–µ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ —à–∞–±–ª–æ–Ω–µ

---

### –ò—Ç–µ—Ä–∞—Ü–∏—è 6: UI –∏ JavaScript

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –ø–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤

**–ó–∞–¥–∞—á–∏:**
- [ ] –û–±–Ω–æ–≤–∏—Ç—å `results.html`:
  - –î–æ–±–∞–≤–∏—Ç—å –ø–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 385
  - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
- [ ] –î–æ–±–∞–≤–∏—Ç—å JavaScript —Ñ—É–Ω–∫—Ü–∏–∏:
  - `loadFilterFields()` - –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
  - `onFilterFieldChange()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—è
  - `checkActiveFilter()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
  - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ "–ü—Ä–∏–º–µ–Ω–∏—Ç—å" –∏ "–°–±—Ä–æ—Å–∏—Ç—å"

**–¢–µ—Å—Ç:**
```bash
# 1. –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ
http://localhost:8081/statistics/results?clientId=1&templateId=1&exportSessionIds=1,2

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
# - –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤–∏–¥–Ω–∞ (–µ—Å–ª–∏ –≤ —à–∞–±–ª–æ–Ω–µ –µ—Å—Ç—å statisticsFilterFields)
# - –í –ø–µ—Ä–≤–æ–º select –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ø–æ–ª—è
# - –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ø–æ–ª—è –≤–æ –≤—Ç–æ—Ä–æ–º select –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è
# - –ö–Ω–æ–ø–∫–∞ "–ü—Ä–∏–º–µ–Ω–∏—Ç—å" –∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∑–Ω–∞—á–µ–Ω–∏—è
# - –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
# - –ü–æ–∫–∞–∑–∞–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞
# - –ö–Ω–æ–ø–∫–∞ "–°–±—Ä–æ—Å–∏—Ç—å" —É–¥–∞–ª—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
```

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –ü–∞–Ω–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã UI —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
- ‚úÖ –°–±—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ

---

### –ò—Ç–µ—Ä–∞—Ü–∏—è 7: –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–¶–µ–ª—å:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã

**–ó–∞–¥–∞—á–∏:**
- [ ] –°–∫–≤–æ–∑–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
  - –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
  - –í—ã–ø–æ–ª–Ω–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç
  - –û—Ç–∫—Ä—ã—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
  - –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å edge cases:
  - –®–∞–±–ª–æ–Ω –±–µ–∑ –ø–æ–ª–µ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
  - –ü–æ–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –±–µ–∑ –∑–Ω–∞—á–µ–Ω–∏–π
  - –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞
  - –†–∞–∑–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
  - –î–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤ `idea_extend_statistics.md`
  - –û–±–Ω–æ–≤–∏—Ç—å `CLAUDE.md` —Å –Ω–æ–≤—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º

**–¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞:**
```
1. –°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω —ç–∫—Å–ø–æ—Ä—Ç–∞
   ‚úì –ü–æ–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏: product_additional4
   ‚úì –ü–æ–ª—è –ø–æ–¥—Å—á–µ—Ç–∞: competitor_price, competitorPromotionalPrice
   ‚úì –ü–æ–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏: competitorStockStatus

2. –í—ã–ø–æ–ª–Ω–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç (2-3 –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ä–∞–∑–Ω–æ–µ –≤—Ä–µ–º—è)

3. –û—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
   ‚úì –í–∏–¥–Ω–∞ –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
   ‚úì –í–∏–¥–Ω–∞ –ø–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤

4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä "–í –Ω–∞–ª–∏—á–∏–∏"
   ‚úì –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã
   ‚úì –ü–æ–∫–∞–∑–∞–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ñ–∏–ª—å—Ç—Ä–∞
   ‚úì URL —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞

5. –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä –Ω–∞ "–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏"
   ‚úì –î–∞–Ω–Ω—ã–µ —Å–Ω–æ–≤–∞ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã
   ‚úì –¶–∏—Ñ—Ä—ã –æ—Ç–ª–∏—á–∞—é—Ç—Å—è

6. –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
   ‚úì –í–µ—Ä–Ω—É–ª–∏—Å—å –∫ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ
   ‚úì –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∫—Ä—ã—Ç

7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ë–î
   ‚úì –ó–∞–ø–∏—Å–∏ —Å filter_field_name = NULL (–æ–±—â–∏–µ)
   ‚úì –ó–∞–ø–∏—Å–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
   ‚úì –°—É–º–º—ã —Å—Ö–æ–¥—è—Ç—Å—è
```

**–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ edge cases –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ merge –≤ main

---

## üìù –ó–∞–º–µ—Ç–∫–∏ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
mvn spring-boot:run -Dspring-boot.run.profiles=silent

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
psql -d zoomos_v4 -c "SELECT * FROM export_statistics WHERE filter_field_name IS NOT NULL LIMIT 10;"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π
mvn flyway:info

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
mvn clean package
```

### –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏:
1. ‚úÖ –ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
2. ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
3. ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
4. ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ

### –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ú–∞–∫—Å–∏–º—É–º 10 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –ø–æ–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è)
- –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–∏–ª—å—Ç—Ä –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (–Ω–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª–µ–π, —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ `statisticsFilterFields` —à–∞–±–ª–æ–Ω–∞

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [idea_extend_statistics.md](idea_extend_statistics.md) - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏—á–∏
- [vision.md](vision.md) - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –≤–∏–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- [conventions.md](conventions.md) - Code conventions

---

**–°–æ–∑–¥–∞–Ω–æ:** 2025-10-04
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-04
**–°—Ç–∞—Ç—É—Å:** üîÑ –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
